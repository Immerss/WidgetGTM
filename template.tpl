___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Immerss Widget",
  "categories": ["SALES"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "How to share widget by the tag manager",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "appId",
    "displayName": "Application ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$"
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const setInWindow = require('setInWindow');
const callInWindow = require('callInWindow');
const injectScript = require('injectScript');

var appId = data.appId;
log('ImmerssWidget:appId', appId);

setInWindow('Immerss', {
    service_id: appId,
    listViewed: [],
    listWish: [],
    listBag: [],
});

const successHandler = function() {
  log('ImmerssWidget: Success loaded.');
  callInWindow('imrsWidgetLoaded');
  data.gtmOnSuccess();
};

const failureHandler = function() {
  log('ImmerssWidget: Loaded with failure!');
  data.gtmOnFailure();
};

const url = 'https://portal.immerss.live/immerss-widget/immerss-widget.js';
log('ImmerssWidget:widgetUrl', url);
injectScript(url, successHandler, failureHandler, 'imrsWidget');


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Immerss"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "imrsWidgetLoaded"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://portal.immerss.live/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 28.06.2022, 15:15:24


